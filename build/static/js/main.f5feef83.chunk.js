(this["webpackJsonpsushi-go"]=this["webpackJsonpsushi-go"]||[]).push([[0],{34:function(e,a,t){e.exports=t(56)},56:function(e,a,t){"use strict";t.r(a);var s=t(0),r=t.n(s),c=t(28),n=t(3),l=t(4),o=t(6),i=t(5),d=t(20),m=t(14),u=t(16),p=t(8),h=t(29),y=t.n(h),f=t(30),g=t.n(f).a.initializeApp({apiKey:"AIzaSyDNF0tW0P_WQmbTug2hN7zG97MDKpKDVvQ",authDomain:"arobillard-games.firebaseapp.com",databaseURL:"https://arobillard-games.firebaseio.com"}),b=y.a.createClass(g.database()),v=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).displayTitle=function(){return void 0===e.props.subtitle?r.a.createElement(d.b,{to:"/"},r.a.createElement("h1",{className:"logo"},"S",r.a.createElement("span",{className:"s-hide"},"ushi "),"G",r.a.createElement("span",{className:"s-hide"},"o"),"!")):r.a.createElement(d.b,{to:"/"},r.a.createElement("strong",{className:"logo"},"S",r.a.createElement("span",{className:"s-hide"},"ushi "),"G",r.a.createElement("span",{className:"s-hide"},"o"),"!"))},e.displaySubtitle=function(){if(void 0!==e.props.subtitle)return r.a.createElement("h1",{className:"subtitle gutter-2 push-0 spread-right"},e.props.subtitle)},e.handleSettings=function(){e.props.handleSettingsDisplay()},e.displayGamecode=function(){if(void 0!==e.props.gamecode)return e.props.host&&e.props.gameStart?r.a.createElement("div",{className:"game-info-wrap pad-t-1-2 pad-b-1-2"},r.a.createElement("button",{onClick:e.handleSettings,className:"push-r-2 ar-icon-wrap"},r.a.createElement("i",{className:"ar-icon-1-1-2 push-1-2 push-r-1-2"},r.a.createElement("img",{src:"images/i-settings.svg",alt:""})),r.a.createElement("span",{className:"ar-icon-label"},"Settings")),r.a.createElement("p",{className:"push-0"},r.a.createElement("span",{className:"gamecode-title"},"Gamecode: "),r.a.createElement("span",{className:"gamecode push-l"},e.props.gamecode))):r.a.createElement("div",{className:"game-info-wrap pad-t-1-2 pad-b-1-2"},r.a.createElement("p",{className:"push-0"},r.a.createElement("span",{className:"gamecode-title"},"Gamecode: "),r.a.createElement("span",{className:"gamecode push-l"},e.props.gamecode)))},e}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("header",{className:"masthead"},r.a.createElement("div",{className:"wrapper gutter"},this.displayTitle(),this.displaySubtitle(),this.displayGamecode()))}}]),t}(r.a.Component),E=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){return Object(n.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("div",{className:"wrapper grid-flex-v-bottom pad-t-b-1-1-2 gutter-1-2"},r.a.createElement("div",{className:"xs-1 m-1-2 island-1-2"},r.a.createElement("strong",{className:"logo headline-1 block"},"Sushi Go!"),r.a.createElement("p",{className:"body-2 push-0"},"Based on popular table top game ",r.a.createElement("a",{href:"https://gamewright.com/product/Sushi-Go",target:"_blank",rel:"noopener noreferrer"},"Sushi Go")," by ",r.a.createElement("a",{href:"https://gamewright.com/",target:"_blank",rel:"noopener noreferrer"},"Gamewright"),".")),r.a.createElement("div",{className:"xs-1 m-1-2 island-1-2"},r.a.createElement("p",{className:"body-2 push-0"},"Designed and developed for personal use only by ",r.a.createElement("a",{href:"https://adamrobillard.ca"},"Adam Robillard"),"."),r.a.createElement("p",{className:"body-2 push-0"},"Sushi illustrations by ",r.a.createElement("a",{href:"https://hannahdel.ca"},"Hannah Delaney"),"."))))}}]),t}(r.a.Component),N={egg:{title:"Egg",family:"nigiri",type:"nigiri",value:1,count:4,color:"yellow",scoreDesc:"Nigiri 1",wasabi:!1},salmon:{title:"Salmon",family:"nigiri",type:"nigiri",value:2,count:5,color:"yellow",scoreDesc:"Nigiri 2",wasabi:!1},squid:{title:"Squid",family:"nigiri",type:"nigiri",value:3,count:3,color:"yellow",scoreDesc:"Nigiri 3",wasabi:!0},"maki-1":{title:"Maki",family:"maki",type:"rolls",value:1,count:4,color:"red",scoreDescL:"Most: 6/4/2",scoreDescS:"Most: 6/3"},"maki-2":{title:"Maki",family:"maki",type:"rolls",value:2,count:4,color:"red",scoreDescL:"Most: 6/4/2",scoreDescS:"Most: 6/3"},"maki-3":{title:"Maki",family:"maki",type:"rolls",value:3,count:3,color:"red",scoreDescL:"Most: 6/4/2",scoreDescS:"Most: 6/3"},tempura:{title:"Tempura",family:"tempura",type:"appetizer",count:8,color:"purple",scoreDesc:"x2 = 5"},sashimi:{title:"Sashimi",family:"sashimi",type:"appetizer",count:8,color:"green",scoreDesc:"x3 = 10"},"miso-soup":{title:"Miso Soup",family:"miso-soup",type:"appetizer",count:8,color:"turquoise",scoreDesc:"Discard If another is played this turn",cancelled:!0},wasabi:{title:"Wasabi",family:"wasabi",type:"special",count:3,color:"yellow",scoreDesc:"Next nigiri x3"},tea:{title:"Tea",family:"tea",type:"special",count:3,color:"burgundy",scoreDesc:"x1 per most colour"},"ice-cream":{title:"Ice Cream",family:"ice-cream",type:"dessert",count:15,color:"light-blue",scoreDesc:"x4 = 12"}};function k(){var e=[];return Object.keys(N).forEach((function(a){for(var t=0;t<N[a].count;)"dessert"!==N[a].type?(e.push(a),t++):t++})),e}var C=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).emptyUsers=function(){for(var a=8-Object.keys(e.props.users).length,t=[],s=0;s<a;)t.push(r.a.createElement("div",{key:"unclaimed-".concat(s),className:"xs-1-2 s-1-3 m-1-4 l-1-3 island-1-2"},r.a.createElement("div",{className:"embed-1by1 player-card no-user"},r.a.createElement("div",{className:"player-card-icon"}),r.a.createElement("h3",{className:"player-card-name"},"---")))),s++;return t},e.handleDeleteUser=function(a){e.props.deleteUser(a.currentTarget.dataset.user)},e}return Object(l.a)(t,[{key:"render",value:function(){var e=this,a=this.props.users;return r.a.createElement("div",{className:"player-card-grid grid-flex"},Object.keys(this.props.users).map((function(t){return r.a.createElement("div",{key:t,className:"xs-1-2 s-1-3 m-1-4 l-1-3 island-1-2"},r.a.createElement("div",{className:"embed-1by1 player-card bg-".concat(a[t].color).concat(a[t].host?" host":"")},r.a.createElement("div",{className:"player-card-icon"}),r.a.createElement("h3",{className:"player-card-name"},a[t].userName),r.a.createElement("button",{className:"player-card-remove","data-user":t,onClick:e.handleDeleteUser,"aria-label":"Delete user"},r.a.createElement("i",{className:"font-alt"},"X"))))})),this.emptyUsers())}}]),t}(r.a.Component),S=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).handleAddUser=function(a){a.preventDefault();var t={userName:a.target.userName.value,color:a.target.color.value,cards:{}},s=Object.keys(e.props.users).length,r=e.props.users,c=Object.keys(e.props.users),n=[];c.forEach((function(e){n.push(r[e].color)})),!0!==n.includes(a.target.color.value)&&s<8&&e.props.addUser(t)},e.colorOptions=function(){var a=["purple","green","turquoise","yellow","cyan","navy","pink","red"],t=e.props.users,s=Object.keys(e.props.users),c=[],n=[],l=0;for(s.forEach((function(e){var s=a.indexOf(t[e].color);c.push(t[e].color),a.splice(s,1)}));l<a.length;)n.push(r.a.createElement("div",{key:a[l],className:"color-swatch"},r.a.createElement("input",{id:"c-".concat(a[l]),type:"radio",name:"color",value:a[l],defaultChecked:0===l,required:!0}),r.a.createElement("label",{className:"bg-".concat(a[l]),htmlFor:"c-".concat(a[l])},r.a.createElement("span",null,"Purple")))),l++;for(l=0;l<c.length;)n.push(r.a.createElement("div",{key:c[l],className:"color-swatch"},r.a.createElement("input",{id:"c-".concat(c[l]),type:"radio",name:"color",value:c[l],disabled:!0}),r.a.createElement("label",{className:"bg-".concat(c[l]),htmlFor:"c-".concat(c[l])},r.a.createElement("span",null,"Purple")))),l++;return n},e}return Object(l.a)(t,[{key:"render",value:function(){return Object.keys(this.props.users).length>=8?r.a.createElement("form",{className:"pop-up-add-user island-2",onSubmit:this.handleAddUser},r.a.createElement("h2",null,"Sorry, this game is full!")):r.a.createElement("form",{className:"pop-up-add-user island-2",onSubmit:this.handleAddUser},r.a.createElement("h2",null,"Enter your name and pick a colour!"),r.a.createElement("div",{className:"grid-colors"},this.colorOptions()),r.a.createElement("div",{className:"grid-flex"},r.a.createElement("input",{name:"userName",type:"text",ref:this.userNameInput,required:!0,placeholder:"User Name",defaultValue:this.props.localUser}),r.a.createElement("button",{className:"btn btn-medium btn-no-shadow",type:"submit"},"Join")))}}]),t}(r.a.Component),O=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).usersDisplay=function(){return Object.keys(e.props.users).includes(e.props.localUser)?r.a.createElement(C,{users:e.props.users,deleteUser:e.props.deleteUser}):r.a.createElement(S,{addUser:e.props.addUser,localUser:e.props.localUser,users:e.props.users})},e.startGame=function(){var a=e.props.localUser,t=e.props.users;if(void 0!==t[a]&&!0===t[a].host)return r.a.createElement("button",{className:"btn btn-medium",onClick:e.props.startGame},"Start Game!")},e}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"wrapper grid-flex-v-middle gutter-1-2 pad-t-1-2 pad-b-4"},r.a.createElement("div",{className:"gamecode-box xs-1 l-1-2 island-1-2"},r.a.createElement("h2",{className:"text-purple shadow-t-pink-2"},"Gamecode"),r.a.createElement("strong",{className:"gamecode-large block font-alt text-pink shadow-t-purple-4"},this.props.gamecode),this.startGame()),r.a.createElement("div",{className:"xs-1 l-1-2 island-1-2"},this.usersDisplay()))}}]),t}(r.a.Component),j=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).state={confirm:!1},e.handlePlayCard=function(a){e.state.confirm||e.setState({confirm:!0})},e.askConfirm=function(){if(e.state.confirm)return r.a.createElement("div",{className:"card-confirm"},r.a.createElement("button",{className:"btn push",onClick:e.confirmCard},"Confirm"),r.a.createElement("button",{className:"btn btn-pink",onClick:e.cancelCard},"Cancel"))},e.confirmCard=function(a){var t=a.currentTarget.closest(".card-sushi").dataset.card;e.props.userPlayCard(t),e.setState({confirm:!1})},e.cancelCard=function(a){e.setState({confirm:!1})},e.displayMakiIcons=function(){for(var a=e.props.cardData,t=[],s=0;s<a.value;)t.push(r.a.createElement("li",{key:"maki-".concat(s+1)},r.a.createElement("img",{className:"maki-icon",src:"images/maki.svg",alt:"Maki"}))),s++;return t},e}return Object(l.a)(t,[{key:"render",value:function(){var e=this.props.cardData,a=Object.keys(this.props.users).length;return"maki"===e.family?r.a.createElement("div",{onClick:this.props.showConfirm?this.handlePlayCard:null,"data-card":this.props.index,className:"card-sushi maki".concat(this.props.revealed?"":" not-revealed")},r.a.createElement("ul",{className:"card-maki-icons list-group-flex push-0"},this.displayMakiIcons()),r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:"images/maki.svg",alt:""})),r.a.createElement("div",{className:"card-info"},r.a.createElement("h3",{className:"card-title"},e.title),r.a.createElement("h4",{className:"card-score-desc"},a<6?e.scoreDescS:e.scoreDescL)),this.askConfirm()):r.a.createElement("div",{onClick:this.props.showConfirm?this.handlePlayCard:null,"data-card":this.props.index,className:"card-sushi".concat(e.family?" ".concat(e.family):"").concat(this.props.wasabiApplied?" wasabi-applied":"").concat(this.props.cancelled?" miso-cancelled":"").concat(this.props.revealed?"":" not-revealed")},r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:"images/".concat(this.props.img,".svg"),alt:""})),r.a.createElement("div",{className:"card-info"},r.a.createElement("h3",{className:"card-title"},e.title),r.a.createElement("h4",{className:"card-score-desc"},e.scoreDesc)),this.askConfirm())}}]),t}(r.a.Component),w=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){return Object(n.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){var e=this.props.cardData;return"maki"===e.family||"nigiri"===e.family?r.a.createElement("div",{className:"card-sushi ".concat("Wasabi"===e.title?"wasabi":e.family).concat(this.props.wasabiApplied?" wasabi-applied":"").concat(this.props.revealed?"":" not-revealed")},r.a.createElement("div",{className:"card-img-wrap"},r.a.createElement("span",{className:"card-points"},e.value),r.a.createElement("img",{src:"images/".concat("maki"===e.family?"maki":this.props.img,".svg"),alt:e.title}))):r.a.createElement("div",{className:"card-sushi ".concat(e.family).concat(this.props.cancelled?" miso-cancelled":"").concat(this.props.revealed?"":" not-revealed")},r.a.createElement("div",{className:"card-img-wrap"},r.a.createElement("img",{src:"images/".concat(this.props.img,".svg"),alt:e.title})))}}]),t}(r.a.Component),x=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=a.call.apply(a,[this].concat(r))).state={score:0},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=this.state.score,t=setInterval((function(){a+=1,e.setState({score:a})}),50);setTimeout((function(){clearInterval(t),e.setState({score:e.props.score})}),50*this.props.score+50)}},{key:"render",value:function(){var e=this.props.userData;return r.a.createElement("div",{className:"xs-1-2 m-1-4 island-1-2"},r.a.createElement("div",{className:"points-grid-item bg-".concat(e.color," embed-1by1")},r.a.createElement("div",null,r.a.createElement("h3",{className:"headline-4"},e.userName),r.a.createElement("strong",null,this.state.score))))}}]),t}(r.a.Component),D=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).handleStartNextRound=function(){e.props.startNewRound()},e.handleExitToLobby=function(){e.props.exitToLobby()},e.handleRestart=function(){e.props.exitToLobby(),e.props.startGame()},e.nextRoundBtn=function(){if(Object(p.a)({},e.props.users)[e.props.localUser].host)return r.a.createElement("div",{className:"island"},3===e.props.round?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"btn push-r",onClick:e.handleExitToLobby},"Return to Lobby"),r.a.createElement("button",{className:"btn btn-pink",onClick:e.handleRestart},"Restart Game")):r.a.createElement("button",{className:"btn",onClick:e.handleStartNextRound},"Start Next Round!"))},e}return Object(l.a)(t,[{key:"render",value:function(){var e,a=Object(p.a)({},this.props.users),t=Object.keys(a),s=t.length;return 2===s||4===s||7===s||8===s?e=4:3!==s&&5!==s&&6!==s||(e=3),r.a.createElement("div",{className:"pop-up-round-end island"},r.a.createElement("div",{className:"island"},r.a.createElement("h2",{className:"headline-1"},3===this.props.round?"Game Over!":"End of Round ".concat(this.props.round))),r.a.createElement("div",{className:"points-grid grid-flex island-1-2"},t.map((function(t){var s=a[t];return r.a.createElement(x,{key:"points-".concat(t),userData:s,widthL:e,score:s.score?s.score:"0"})}))),this.nextRoundBtn())}}]),t}(r.a.Component),U=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).state={handVisible:!0},e.teaRef=r.a.createRef(),e.userPlayCard=function(a){e.props.playCard(a)},e.showHand=function(){var a=e.props.localUser,t=Object(p.a)({},e.props.users),s=e.props.hands[t[a].handRef],c=[],n=[],l=!!t[a].playedCards&&t[a].playedCards.ready,o=0;s&&s.forEach((function(e){c.includes(N[e].family)||c.push(N[e].family)}));var i=1;return c.forEach((function(a){s.forEach((function(s){if(N[s].family===a){o++;var c=N[s];n.push(r.a.createElement(j,{key:"card-".concat(i,"-").concat(s),index:s,img:s,cardData:c,users:t,userPlayCard:e.userPlayCard,showConfirm:!0,revealed:!0})),i++}}))})),r.a.createElement("aside",{className:"hand bg-".concat(e.props.users[e.props.localUser].color,"-faded").concat(e.state.handVisible?" open":"").concat(l?" locked":"")},r.a.createElement("button",{onClick:e.handleHandVisibility,className:"hand-title bg-".concat(e.props.users[e.props.localUser].color),tabIndex:"0"},r.a.createElement("div",{className:"hand-title-rotate"},r.a.createElement("h2",null,"Your Hand")),r.a.createElement("span",{className:"headline-3"},e.state.handVisible?"X":"<")),r.a.createElement("div",{className:"hand-cards island hand-size-".concat(o)},n))},e.handleHandVisibility=function(){e.state.handVisible?e.setState({handVisible:!1}):e.setState({handVisible:!0})},e.myPlayedCards=function(){var a=e.props.localUser,t=Object(p.a)({},e.props.users),s=t[a].playedCards?t[a].playedCards.cards:[],c=[],n=[];s&&s.forEach((function(e){c.includes(N[e.card].family)||("wasabi"!==N[e.card].family||c.includes("nigiri")?c.push(N[e.card].family):c.push("nigiri"))}));var l=1,o={family:null,length:0};if(c.forEach((function(a){var c=0;if("ice-cream"!==a&&"wasabi"!==a&&"tea"!==a){var i=[];s.forEach((function(s){var n=N[s.card];"maki"===a&&"maki"===n.family&&(c+=n.value),n.family===a&&(i.push(r.a.createElement(j,{key:"".concat(a,"-").concat(l,"-").concat(s.card),index:s.card,img:s.card,cardData:n,users:t,userPlayCard:e.userPlayCard,showConfirm:!1,cancelled:s.cancelled,wasabiApplied:s.wasabiApplied,revealed:s.revealed})),l++)})),"maki"===a&&i.push(r.a.createElement("div",{key:"my-maki-count",className:"maki-count"},r.a.createElement("span",null,c))),s.forEach((function(s){var c=N[s.card];"wasabi"===c.family&&"nigiri"===a&&(i.push(r.a.createElement(j,{key:"".concat(a,"-").concat(l,"-").concat(s.card),index:s.card,img:s.card,cardData:c,users:t,userPlayCard:e.userPlayCard,showConfirm:!1,cancelled:s.cancelled,revealed:s.revealed})),l++)})),i.length>o.length&&(o.length=i.length,o.family=a),n.push(r.a.createElement("div",{key:a,className:"sushi-family ".concat(a)},i))}})),n.forEach((function(a){a.key===o.family&&"tea"!==a.key&&s.forEach((function(s){var c=N[s.card];"tea"===c.family&&(a.props.children.push(r.a.createElement(j,{ref:e.teaRef,key:"tea-".concat(l,"-").concat(s.card),index:s.card,img:s.card,cardData:c,users:t,userPlayCard:e.userPlayCard,showConfirm:!1,revealed:s.revealed})),l++)}))})),0===o.length){var i=[];s&&s.forEach((function(a){var s=N[a.card];"tea"===s.family&&(i.push(r.a.createElement(j,{key:"tea-".concat(l,"-").concat(a.card),index:a.card,img:a.card,cardData:s,users:t,userPlayCard:e.userPlayCard,showConfirm:!1,revealed:a.revealed})),l++)})),n.push(r.a.createElement("div",{key:"tea",className:"sushi-family tea"},i))}return r.a.createElement("div",{className:"sushi-layout"},n)},e.displayDessert=function(){var a=e.props.localUser,t=Object(p.a)({},e.props.users),s=!!t[a].playedCards&&t[a].playedCards.cards,c=[],n=1;return s&&s.forEach((function(a){var s=N[a.card];"ice-cream"===s.family&&(c.push(r.a.createElement(j,{key:"ice-cream-".concat(n),index:a.card,img:a.card,cardData:s,users:t,userPlayCard:e.userPlayCard,showConfirm:!1,revealed:a.revealed})),n++)})),c},e.displayPlayerPlayedCards=function(){var a=e.props.localUser,t=Object(p.a)({},e.props.users),s=Object.keys(t),c=[];return s.forEach((function(e){if(e!==a){var s=!!t[e].playedCards&&t[e].playedCards.cards,n=[],l=[];s&&s.forEach((function(e){n.includes(N[e.card].family)||("wasabi"!==N[e.card].family||n.includes("nigiri")?n.push(N[e.card].family):n.push("nigiri"))}));var o=1,i={family:null,length:0};if(n.forEach((function(a){var t=0;if("ice-cream"!==a&&"wasabi"!==a&&"tea"!==a){var c=[];s.forEach((function(s){var n=N[s.card];"maki"===a&&"maki"===n.family&&!0===s.revealed&&(t+=n.value),n.family===a&&(c.push(r.a.createElement(w,{key:"".concat(e,"-").concat(s.card,"-").concat(o),cardData:N[s.card],img:s.card,cancelled:s.cancelled,wasabiApplied:s.wasabiApplied,revealed:s.revealed})),o++)})),"maki"===a&&0!==t&&c.push(r.a.createElement("div",{key:"".concat(e,"-maki-count"),className:"maki-count"},r.a.createElement("span",null,t))),s.forEach((function(t){"wasabi"===N[t.card].family&&"nigiri"===a&&(c.push(r.a.createElement(w,{key:"".concat(e,"-").concat(t.card,"-").concat(o),cardData:N[t.card],img:t.card,revealed:t.revealed})),o++)})),c.length>i.length&&(i.length=c.length,i.family=a),l.push(r.a.createElement("div",{key:a,className:"sushi-family ".concat(a)},c))}})),l.forEach((function(a){a.key===i.family&&"tea"!==a.key&&s.forEach((function(t){"tea"===N[t.card].family&&(a.props.children.push(r.a.createElement(w,{key:"".concat(e,"-").concat(t.card,"-").concat(o),cardData:N[t.card],img:t.card,revealed:t.revealed})),o++)}))})),0===i.length){var d=[];s&&s.forEach((function(a){"tea"===N[a.card].family&&(d.push(r.a.createElement(w,{key:"".concat(e,"-").concat(a.card,"-").concat(o),cardData:N[a.card],img:a.card,revealed:a.revealed})),o++)})),l.push(r.a.createElement("div",{key:"tea",className:"sushi-family tea"},d))}o=1;var m=[];s&&s.forEach((function(a){"ice-cream"===N[a.card].family&&(m.push(r.a.createElement(w,{key:"".concat(e,"-").concat(a.card,"-").concat(o),cardData:N[a.card],img:a.card,revealed:a.revealed})),o++)}));var u=!!t[e].playedCards&&t[e].playedCards.ready;c.push(r.a.createElement("div",{key:e,className:"card-column bg-".concat(t[e].color,"-faded")},r.a.createElement("div",{className:"panel-score bg-".concat(t[e].color).concat(u?" ready":"")},r.a.createElement("h2",null,e,":"),r.a.createElement("strong",{className:"score"},t[e].score?t[e].score:0)),r.a.createElement("div",{className:"panel-cards"},l),r.a.createElement("div",{className:"panel-dessert bg-".concat("pink"===t[e].color?"purple":"pink")},m)))}})),c},e.handleReady=function(){var a=e.props.localUser;e.props.setReady(a)},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keydown",(function(a){"Escape"===a.key&&(e.props.settingsDisplayed?e.props.handleSettingsDisplay():e.handleHandVisibility())}))}},{key:"render",value:function(){var e=this.props.localUser,a=this.props.users,t=!!a[e].playedCards&&a[e].playedCards.ready,s=Object.keys(a).length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"card-panels wrapper gutter-1-2".concat(!0===this.props.roundEnd?" opacity-1-4":"")},r.a.createElement("section",{className:"local-user-cards gutter-1-2"},r.a.createElement("div",{className:"panel-wrap bg-".concat(a[e].color,"-faded")},r.a.createElement("div",{className:"panel-score bg-".concat(a[e].color)},r.a.createElement("strong",{className:"score"},this.props.users[e].score?this.props.users[e].score:0),r.a.createElement("button",{className:"btn-ready".concat(t?" ready":""),onClick:this.handleReady},"Ready",t?"!":""),a[e].host?r.a.createElement("span",{className:"host-badge bg-pink"},"H"):null),r.a.createElement("div",{className:"panel-cards"},r.a.createElement("h2",null,"Your Sushi"),this.myPlayedCards()),r.a.createElement("div",{className:"panel-dessert bg-".concat("pink"===a[e].color?"purple":"pink")},r.a.createElement("h3",null,"Dessert"),r.a.createElement("div",{className:"dessert-cards"},this.displayDessert())))),r.a.createElement("section",{className:"user-cards gutter-1-2 push opponent-amount-".concat(s)},this.displayPlayerPlayedCards())),this.showHand(),!0===this.props.roundEnd?r.a.createElement(D,{users:this.props.users,localUser:this.props.localUser,newRound:this.props.newRound,startNewRound:this.props.startNewRound,calculateScore:this.props.calculateScore,round:this.props.round,exitToLobby:this.props.exitToLobby,startGame:this.props.startGame}):null)}}]),t}(r.a.Component),R=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,r=new Array(s),c=0;c<s;c++)r[c]=arguments[c];return(e=a.call.apply(a,[this].concat(r))).handleExitToLobby=function(){e.props.exitToLobby()},e.handleRestart=function(){e.props.exitToLobby(),e.props.startGame()},e}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"pop-up-settings island-2"},r.a.createElement("h2",{className:"push-2"},"Settings"),r.a.createElement("button",{onClick:this.props.handleSettingsDisplay,className:"btn-x-close"},"X"),r.a.createElement("div",{className:"settings-grid"},r.a.createElement("div",{className:"grid-flex-v-middle grid-flex-h-split push"},r.a.createElement("h3",{className:"headline-5 push-0"},"Quit current game:"),r.a.createElement("button",{className:"btn",onClick:this.handleExitToLobby},"Exit to Lobby")),r.a.createElement("div",{className:"grid-flex-v-middle grid-flex-h-split"},r.a.createElement("div",null,r.a.createElement("h3",{className:"headline-5 push-0"},"Restart game:"),r.a.createElement("p",{className:"push body-2"},"This will start a new game with new random hands.")),r.a.createElement("button",{className:"btn",onClick:this.handleRestart},"Restart Game"))))}}]),t}(r.a.Component),P=t(33),G=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).state={deck:{},users:{},localUser:"",gameStart:{},round:{},roundEnd:!1,hands:{},settingsDisplayed:!1,misoPlayed:!1,roundScoreCalculated:!1,gameTime:Date.now()},e.addUser=function(a){var t=Object.keys(e.state.users).length,s=Object(p.a)({},e.state.users);0===t?(a.host=!0,s[a.userName]=a,e.setState({users:s,localUser:a.userName})):(s[a.userName]=a,e.setState({users:s,localUser:a.userName}))},e.deleteUser=function(a){var t=Object(p.a)({},e.state.users);if(!0===t[a].host){t[a]=null;var s=Object.keys(t);void 0!==t[s[1]]&&(null===t[s[0]]?t[s[1]].host=!0:t[s[0]].host=!0),e.setState({users:t})}else t[a]=null,e.setState({users:t})},e.startGame=function(){var a=Object.keys(e.state.users).length,t=k();e.newRound(a,t,!0),e.setState({gameStart:!0,gameTime:P.DateTime.now().toISODate()})},e.startNewRound=function(){var a=Object.keys(e.state.users).length,t=[],s=k();e.state.deck.forEach((function(e){"ice-cream"===e&&t.push(e)}));var r=[].concat(Object(u.a)(s),t);console.log(t),console.log(s),console.log(r),e.newRound(a,r,!1),e.setState({roundEnd:!1,roundScoreCalculated:!1})},e.newRound=function(a,t,s){var r,c=Object(u.a)(t),n=0;if(s?(r=1,e.setState({round:r})):(r=e.state.round+1,e.setState({round:r})),1===r)for(;n<(a<6?5:7);)c.push("ice-cream"),n++;else if(2===r)for(;n<(a<6?3:5);)c.push("ice-cream"),n++;else if(3===r)for(;n<(a<6?2:3);)c.push("ice-cream"),n++;setTimeout((function(){e.dealCards(c)}),1)},e.dealCards=function(a){var t,s=Object(u.a)(a),r=[],c=Object.keys(e.state.users),n=c.length,l=Object(p.a)({},e.state.users),o=0,i=0;for(t=n<4?10:n<6?9:n<8?8:7;o<t;){for(var d=0;d<n;d++){var m=Math.floor(Math.random()*s.length),h=s[m];void 0===r[d]?(r[d]=[],r[d].push(h)):r[d].push(h),s.splice(m,1)}o++}for(;i<n;)l[c[i]].handRef=i,l[c[i]].playedCards&&l[c[i]].playedCards.cards.length>1?function(){var e=[];l[c[i]].playedCards.cards.forEach((function(a,t){"ice-cream"===a.card&&e.push({card:"ice-cream",revealed:!0})})),l[c[i]].playedCards={cards:[].concat(e),ready:!1,wasabiWaiting:!1,doubleWasabiWaiting:!1,tripleWasabiWaiting:!1}}():l[c[i]].playedCards={cards:[],ready:!1,wasabiWaiting:!1,doubleWasabiWaiting:!1,tripleWasabiWaiting:!1},i++;e.setState({deck:s,hands:r,users:l})},e.playCard=function(a){var t=e.state.localUser,s=Object(p.a)({},e.state.users),r=Object.keys(s),c=Object(p.a)({},e.state.hands);s[t].playedCards.cards||(s[t].playedCards.cards=[]),"egg"!==a&&"squid"!==a&&"salmon"!==a||!s[t].playedCards.wasabiWaiting?"miso-soup"===a?!0===e.state.misoPlayed?(r.forEach((function(e){var a=0,t=[];s[e].playedCards.cards&&(t=Object(u.a)(s[e].playedCards.cards),a=s[e].playedCards.cards.length);var r=t.pop();r&&"miso-soup"===r.card&&s[e].playedCards.ready&&(s[e].playedCards.cards[a-1].cancelled=!0)})),s[t].playedCards.cards.push({card:a,scored:!1,revealed:!1,cancelled:!0})):(s[t].playedCards.cards.push({card:a,scored:!1,revealed:!1,cancelled:!1}),e.setState({misoPlayed:!0})):s[t].playedCards.cards.push({card:a,scored:!1,revealed:!1}):(s[t].playedCards.cards.push({card:a,scored:!1,revealed:!1,wasabiApplied:!0}),s[t].playedCards.tripleWasabiWaiting?s[t].playedCards.tripleWasabiWaiting=!1:s[t].playedCards.doubleWasabiWaiting?s[t].playedCards.doubleWasabiWaiting=!1:s[t].playedCards.wasabiWaiting=!1),"wasabi"===a&&(s[t].playedCards.doubleWasabiWaiting?s[t].playedCards.tripleWasabiWaiting=!0:s[t].playedCards.wasabiWaiting&&(s[t].playedCards.doubleWasabiWaiting=!0),s[t].playedCards.wasabiWaiting=!0),s[t].playedCards.ready=!0,e.setState({users:s});for(var n=0,l=!1;n<r.length;){if(!s[r[n]].playedCards.ready){n++,l=!1;break}l=!0,n++}l&&(c[0].length>1&&r.forEach((function(e){var a=s[e].handRef,t=s[e].playedCards.cards.length-1,r=s[e].playedCards.cards[t].card,n=[].concat(Object(u.a)(c[a].slice(0,c[a].indexOf(r))),Object(u.a)(c[a].slice(c[a].indexOf(r)+1)));c[a]=n})),e.revealCards(),e.setState({misoPlayed:!1,hands:c}))},e.setReady=function(a){var t=Object(p.a)({},e.state.users);t[a].playedCards.ready=!0,e.setState({users:t})},e.revealCards=function(){var a=Object(p.a)({},e.state.users),t=Object.keys(a),s=Object(u.a)(e.state.hands);t.forEach((function(r){a[r].playedCards.cards.forEach((function(e){e.revealed=!0})),a[r].handRef===t.length-1?a[r].handRef=0:a[r].handRef++,s[0].length<=1?setTimeout((function(){!0!==e.state.roundScoreCalculated&&e.calculateScore(),e.setState({roundEnd:!0,roundScoreCalculated:!0})}),1e3):a[r].playedCards.ready=!1})),e.setState({users:a})},e.calculateScore=function(){var a=Object(p.a)({},e.state.users),t=Object.keys(a),s=t.length,r={},c=e.state.round;if(t.forEach((function(e){var t=a[e].playedCards.cards,s=0,n=0,l=0,o=0,i=0,d=0,m={};if(a[e].score&&(s=a[e].score),t.forEach((function(e){m[N[e.card].family]?"wasabi"===N[e.card].family?m.nigiri=m.nigiri+1:m[N[e.card].family]=m[N[e.card].family]+1:"wasabi"===N[e.card].family?m.nigiri=1:m[N[e.card].family]=1,e.scored||("nigiri"===N[e.card].family?(e.wasabiApplied?s+=3*N[e.card].value:s+=N[e.card].value,e.scored=!0):"miso-soup"!==N[e.card].family||e.cancelled?"tempura"===e.card?(n++,e.scored=!0):"sashimi"===e.card?(l++,e.scored=!0):"maki"===N[e.card].family?(o+=N[e.card].value,e.scored=!0):"tea"===N[e.card].family?i+=1:3===c&&"ice-cream"===N[e.card].family&&(d+=1,e.scored=!0):(s+=3,e.scored=!0))})),n>=2){var u=5*Math.floor(n/2);s+=u}if(l>=3){var p=10*Math.floor(l/3);s+=p}if(o>0&&(r[e]=o),i>0){var h=Object.entries(m).sort((function(e,a){var t=e[1];return a[1]-t}));s+=h[0][1]*i,console.log(e,i),console.log(e,h[0]),console.log(e,h[0][1]*i)}if(d>=4){var y=12*Math.floor(d/4);s+=y}a[e].score=s,a[e].playedCards.cards=t})),0!==Object.keys(r).length){var n,l,o,i,d,m=Object.entries(r).sort((function(e,a){var t=e[1];return a[1]-t}));if(s>6)m.forEach((function(e,t){0===t?(a[e[0]].score=a[e[0]].score+6,n=e[1]):1===t?e[1]===n?a[e[0]].score=a[e[0]].score+6:(a[e[0]].score=a[e[0]].score+4,l=e[1]):2===t?e[1]===n?a[e[0]].score=a[e[0]].score+6:e[1]===l?a[e[0]].score=a[e[0]].score+4:(a[e[0]].score=a[e[0]].score+2,o=e[1]):l?o?e[1]===n?a[e[0]].score=a[e[0]].score+6:e[1]===l?a[e[0]].score=a[e[0]].score+4:e[1]===o&&(a[e[0]].score=a[e[0]].score+2):(a[e[0]].score=a[e[0]].score+2,o=e[1]):(a[e[0]].score=a[e[0]].score+4,l=e[1])}));else m.forEach((function(e,t){0===t?(a[e[0]].score=a[e[0]].score+6,i=e[1]):1===t?e[1]===i?a[e[0]].score=a[e[0]].score+6:(a[e[0]].score=a[e[0]].score+3,d=e[1]):d?e[1]===i?a[e[0]].score=a[e[0]].score+6:e[1]===d&&(a[e[0]].score=a[e[0]].score+3):(a[e[0]].score=a[e[0]].score+3,d=e[1])}))}e.setState({users:a})},e.subtitleDisplay=function(){return"object"===typeof e.state.gameStart||!1===e.state.gameStart?"Lobby":"Round ".concat(e.state.round)},e.handleSettingsDisplay=function(){e.state.settingsDisplayed?e.setState({settingsDisplayed:!1}):e.setState({settingsDisplayed:!0})},e.settingsDisplay=function(){return r.a.createElement(R,{handleSettingsDisplay:e.handleSettingsDisplay,exitToLobby:e.exitToLobby,startGame:e.startGame})},e.exitToLobby=function(){var a=Object(p.a)({},e.state.users);Object.keys(a).forEach((function(e){a[e].playedCards=null,a[e].handRef=null,a[e].score=null})),e.setState({gameStart:!1,round:null,hands:null,deck:null,misoPlayed:!1,users:a,roundScoreCalculated:!1,roundEnd:!1}),e.setState({settingsDisplayed:!1})},e.gameBoardDisplay=function(){var a=e.props.match.params.gamecode,t=Object.keys(e.state.users),s=e.state.localUser;if(!0===e.state.gameStart&&t.includes(s)){var c=Object.keys(e.state.users).length;return r.a.createElement(U,{users:e.state.users,localUser:e.state.localUser,deck:e.state.deck,hands:e.state.hands,userCount:c,playCard:e.playCard,settingsDisplayed:e.state.settingsDisplayed,handleSettingsDisplay:e.handleSettingsDisplay,roundEnd:e.state.roundEnd,newRound:e.newRound,startNewRound:e.startNewRound,calculateScore:e.calculateScore,round:e.state.round,exitToLobby:e.exitToLobby,setReady:e.setReady,startGame:e.startGame})}return r.a.createElement(O,{gamecode:a,users:e.state.users,addUser:e.addUser,deleteUser:e.deleteUser,localUser:e.state.localUser,startGame:e.startGame})},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem(this.props.match.params.gamecode);if(e){var a=JSON.parse(e);this.setState({deck:a.deck,users:a.users,gameStart:a.gameStart,round:a.round,hands:a.hands,gameTime:Date.now()}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/deck"),{context:this,state:"deck"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/users"),{context:this,state:"users"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/gameStart"),{context:this,state:"gameStart"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/round"),{context:this,state:"round"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/roundEnd"),{context:this,state:"roundEnd"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/hands"),{context:this,state:"hands"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/misoPlayed"),{context:this,state:"misoPlayed"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/roundScoreCalculated"),{context:this,state:"roundScoreCalculated"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/gameTime"),{context:this,state:"gameTime"})}else this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/deck"),{context:this,state:"deck"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/users"),{context:this,state:"users"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/gameStart"),{context:this,state:"gameStart"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/round"),{context:this,state:"round"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/roundEnd"),{context:this,state:"roundEnd"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/hands"),{context:this,state:"hands"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/misoPlayed"),{context:this,state:"misoPlayed"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/roundScoreCalculated"),{context:this,state:"roundScoreCalculated"}),this.ref=b.syncState("sushi-go/".concat(this.props.match.params.gamecode,"/gameTime"),{context:this,state:"gameTime"});var t=JSON.parse(localStorage.getItem("localUser"));this.setState({localUser:t})}},{key:"componentDidUpdate",value:function(){localStorage.setItem(this.props.match.params.gamecode,JSON.stringify(this.state)),localStorage.setItem("localUser",JSON.stringify(this.state.localUser))}},{key:"render",value:function(){var e=this.props.match.params.gamecode,a=this.state.localUser,t=Object(p.a)({},this.state.users),s=!!t[a]&&t[a].host;return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,{subtitle:this.subtitleDisplay(),gamecode:e,host:s,handleSettingsDisplay:this.handleSettingsDisplay,gameStart:this.state.gameStart}),r.a.createElement("main",{id:"main",role:"main",className:"flex pad-t-6".concat(this.state.settingsDisplayed?" opacity-1-4":"")},this.gameBoardDisplay()),this.state.settingsDisplayed&&this.settingsDisplay(),r.a.createElement(E,null))}}]),t}(r.a.Component);function T(e){return e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function M(){var e=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a=e[Math.floor(Math.random()*e.length)],t=e[Math.floor(Math.random()*e.length)],s=e[Math.floor(Math.random()*e.length)];return a+Math.floor(10*Math.random())+t+Math.floor(10*Math.random())+s}var W=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){var e;Object(n.a)(this,t);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];return(e=a.call.apply(a,[this].concat(c))).gcInput=r.a.createRef(),e.joinGame=function(a){a.preventDefault();var t=e.gcInput.current.value;e.props.history.push("/".concat(T(t)))},e}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null),r.a.createElement("main",{id:"main",role:"main",className:"flex-children-center pad-t-b-8 gutter"},r.a.createElement("form",{className:"pop-up-join-game island-2",onSubmit:this.joinGame},r.a.createElement("h2",null,"Join or host a game!"),r.a.createElement("p",null,"To start a new game, simply enter your name and a new unique ",r.a.createElement("strong",null,"Gamecode")," in the form below and hit ",r.a.createElement("em",null,"Start Playing"),"! If you wish to join a game someone else created, enter your name and their ",r.a.createElement("strong",null,"Gamecode")," and hit ",r.a.createElement("em",null,"Start Playing"),"!"),r.a.createElement("div",{className:"grid-flex"},r.a.createElement("input",{className:"xs-1-2",type:"text",ref:this.gcInput,required:!0,placeholder:"Enter Gamecode",defaultValue:M()}),r.a.createElement("button",{className:"btn btn-medium btn-no-shadow xs-1-2",type:"submit"},"Start Playing!")))),r.a.createElement(E,null))}}]),t}(r.a.Component),L=function(e){Object(o.a)(t,e);var a=Object(i.a)(t);function t(){return Object(n.a)(this,t),a.apply(this,arguments)}return Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",component:W}),r.a.createElement(m.a,{path:"/:gamecode",component:G})))}}]),t}(r.a.Component);Object(c.render)(r.a.createElement(L,null),document.querySelector("#react-loader"))}},[[34,1,2]]]);
//# sourceMappingURL=main.f5feef83.chunk.js.map